{% paginate collection.products by 12 %}
	<div class="container">
		<div class="row">
			<div class="col-lg-3">
				<ul>
	{% assign tagall = '' %}
	{% assign keys = '' %}
{% for tag in collection.all_tags %}				
	{% assign kk = tag | split:":" %}
	{% assign keys = keys | append: kk[0] %}
	{% assign keys = keys | append: '|' %}
{% endfor %} 
{% assign keys = keys | split: '|' | uniq %}
<ul class="sidebar-filter">
	<li>Collection
		<ul>
			{% for link in linklists['collection-list'].links %}
				<li>
		            <a href="{{ link.url }}">
		              {{ link.title }}
		            </a>
				</li>
			{% endfor %}
		</ul>
	</li>
{% for key in keys %}	
		<li>{{ key }}
		<ul>
	{% for tag in collection.all_tags %}
		{% assign kk = tag | split:":" %}
		{% if kk[0] == key %}
		{% if current_tags contains tag %}
             <li data-variant-image="{{ variant_image_url }}" class="current">
               <label>
                 <input  class="filter_checkbox coll-filter" id="checked" type="checkbox" checked onClick="">
                   {% if is_color %}
                     <span style="background-color: {{ css_color }}; background-image: url('{{ swatch_image_url }}');" class="color_filter"></span>
                   {% endif %}
                   {{ kk[1] | link_to_remove_tag: tag }}
               </label>
            </li>
          {% elsif collection.all_tags contains tag %}
            <li data-variant-image="{{ variant_image_url }}">
              <label>
                <input  class="filter_checkbox coll-filter" id="unchecked" type="checkbox" onClick="">
                {% if is_color %}
                  <span style="background-color: {{ css_color }}; background-image: url('{{ swatch_image_url }}');" class="color_filter"></span>
                {% endif %}
                {{ kk[1] | link_to_add_tag: tag }}
              </label>
            </li>
          {% endif %}
		{% endif %}
	{% endfor %}
		</ul></li>
{% endfor %}
</ul>			


			</div>
			<div class="col-lg-9">

			  <div class="row">
			    {% for product in collection.products %}
			      <div class="col-lg-4 product-box">
			        {% if product.featured_image != blank %}
			          <a href="{{ product.url | within: collection }}">
			            {% include 'responsive-image' with
			              image: product.featured_image,
			              max_width: 700,
			              max_height: 800
			            %}
			          </a>
			        {% endif %}
			
			        <p class="product-title">
			          <a href="{{ product.url | within: collection }}">{{ product.title }}</a>
			        </p>
			      </div>
			
			    {% else %}
			      {% if collection.handle == 'all' and collection.all_vendors.size == 0 and collection.all_types.size == 0 %}
			        {% for i in (1..8) %}
			        <div class="col-md-4 product-box">
			          <a href="#">
			            {% capture current %}{% cycle 1, 2, 3, 4, 5, 6 %}{% endcapture %}
			            {{ 'product-' | append: current | placeholder_svg_tag: 'placeholder-svg placeholder-svg--small' }}
			          </a>
			
			          <p class="product-title">
			            <a href="{{ product.url }}">{{ 'homepage.onboarding.product_title' | t }}</a>
			          </p>
	
			        </div>
			        {% endfor %}
			      {% else %}
			        <p>{{ 'collections.general.no_matches' | t }}</p>
			      {% endif %}
			
			    {% endfor %}
			  </div>
  
			</div>
		</div>
	</div>

  {% if paginate.pages > 1 %}
    {% include 'pagination' %}
  {% endif %}
{% endpaginate %}

<script type="text/javascript">
$('.filter_checkbox').off().change( function(){
   	var newURL = $(this).nextAll('a').attr('href');
   	window.location.href = newURL;
   });
</script>
